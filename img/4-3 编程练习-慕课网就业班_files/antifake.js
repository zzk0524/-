define("common/js/antifake",["require"],function(){var t=function(){this.staticQueue=[],this.asyncQueue=[],this.status="running"};t.prototype={next:function(t,n){return n?(this.staticQueue.push("async"),this.asyncQueue.push(t)):this.staticQueue.push(t),this},wait:function(t){var n=this;return this.next(function(){setTimeout(function(){n.wake.call(n)},t)},!0),this},run:function(){for(;this.staticQueue.length>0;){if("sleep"===this.status)return;var t=this.staticQueue.shift();"string"==typeof t&&"async"==t&&(t=this.asyncQueue.shift(),this.status="sleep"),t.call(this)}},wake:function(){this.status="running",this.run()}};var n,i,e,o,s=function(t,n,i){return i&&(n+=1),parseInt(Math.random()*(n-t)+t)},r=function(t){return 10>t?"0"+t:t},u=function(t,n){return"0."+r(s(t,n))},a=function(t,n){var i=Math.floor(t-16*n/9)/2,e=Math.floor(n-9*t/16)/2;i=i>0?i:0,e=e>0?e:0,t-=2*i,n-=2*e;var o=[{x:Math.floor(t*u(1,80)+i),y:20},{x:Math.floor(t*u(1,10)+i),y:Math.floor(n*u(1,80)+e)},{x:Math.floor(t*u(70,80)+i),y:Math.floor(n*u(1,80)+e)},{x:Math.floor(t*u(1,80)+i),y:Math.floor(n*u(70,80)+e)}];return o[s(0,4)]},f=60,c=null,p=[],l=0,h=10,d=10,x=1,v=3,g=0,m=!1,y=!1,M=5,O={},w=function(){d=h,x=1,v=3},I=new t,b=function(){m=!1,g=s(x,v,!0),d-=g,v=v>=d?d:v,setTimeout(function(){m=!0,y=!1},1e3*g)},Q=function(){e&&e.remove(),e=null,i=$(".video-js");var t=i.children("div"),n=t.eq(Math.floor(Math.random()*t.length)),r="12px",u=i.width();u>1300?(u="240",r="16px"):u>1e3?(u="220px",r="14px"):u="180px",o=u;var f="position: absolute; z-index: 998; padding: 5px;";f+="font-weight:bold; color:#000; opacity:0.2;",f+="text-shadow: 1px 0 0px #fff, -1px 0 0px #fff, 0 1px 0px #fff, 0 -1px 0px #fff",f+="font-size: "+r+"; width: "+u;var c='<div style="'+f+'"></div>';l=1==p.length?0:s(0,10)%2,e=$(c).html(p[l]),Math.random()>.5?n.before(e):n.after(e),O=a(i.width(),i.height()-40),e.css({top:O.y+"px",left:O.x+"px"})},T=function(){return clearTimeout(c),m?(e&&e.remove(),void(e=null)):void(c=setTimeout(function(){j(T)},500))},k=function(t,n){return t=t.indexOf("px")>=0?t.substring(0,t.indexOf("px")):t,n=n.indexOf("px")>=0?n.substring(0,n.indexOf("px")):n,t==n?!0:(M=M||5,M>n-t||M>t-n?!0:!1)},j=function(t){if(0==$("#video-container video").length)return void z.stop();if(m)return e&&e.remove(),void(e=null);if(null!=e){var n=0;if($(".video-js div").each(function(t,i){-1!=p.indexOf($(i).html())&&(n=1)}),null==e||e.is(":hidden")||-1==p.indexOf(e.html())?n=0:k(e.css("left"),O.x+"px")&&k(e.css("top"),O.y+"px")&&k(e.css("textIndent"),"0px")&&k(e.css("paddingLeft"),"5px")&&k(e.css("paddingTop"),"5px")&&k(e.css("paddingRight"),"5px")&&k(e.css("paddingBottom"),"5px")?k(e.css("marginLeft"),"0px")&&k(e.css("marginTop"),"0px")&&k(e.css("marginRight"),"0px")&&k(e.css("marginBottom"),"0px")||(n=0):n=0,!n){var i="?cid="+OP_CONFIG.curCourse.id+"&mid="+OP_CONFIG.mid;return $.get("/lesson/ajaxillegal"+i),$("#video-container").html('<p style="color:#fff; text-align:center;padding-top:150px">检测到播放器异常，如您未改动播放器参数，请反馈此问题给慕课网技术人员</p>'),z.stop(),!1}e.css({width:o,textIndent:"0px",padding:"5px",margin:"0",background:"none",color:"#000",display:"block",position:"absolute",zIndex:"998",opacity:"0.2"}),t&&t()}},C=function(){return 0>=d||y?!1:(y=!0,void I.wait(1e3*s(1,10)).next(b).next(Q).next(T).run())},z={start:function(){p.length<=0&&p.push("@"+OP_CONFIG.userInfo.uid),clearInterval(n),n=setInterval(function(){C(),f--,0>=f&&(f=60,w())},1e3)},stop:function(){clearInterval(n),m=!0,y=!1}};return z});