define("sc/js/inc/qa-search",["lesson/js/common","juicer"],function(e){var n={scrolltimer:null,inputBox:".qa-input",input:".qa-input-text",close:".qa-input-close",button:"qa-input-button",qaList:"#origin-qa-wrap",search:".js-qa-search-list",noResult:"#searchNoResult",page:OP_CONFIG.module,uid:OP_CONFIG.userInfo.uid},i=null,t={search:"/sc/ajaxrelatequestion"};QA={init:function(){"sc"==n.page?$.extend(n,{bigContainer:".wenda-big-wrap",pid:$(".wenda-input-text").data("pid")}):"lesson"==n.page&&$.extend(n,{bigContainer:".wenda-wrap",cid:OP_CONFIG.curCourse.id}),QA.bindEvent()},showAnswerCreditTip:function(e){var i=$(e).scrollTop()+300,t=$(".wenda-big-wrap").find(".js-add-tip");0!=t.length&&(n.scrolltimer&&clearTimeout(n.scrolltimer),n.scrolltimer=setTimeout(function(){$.each(t,function(e,n){$(n).removeClass("slow-show"),"undefined"!=typeof $(t[e+1]).offset()&&i>Number($(n).offset().top)-200&&i<Number($(t[e+1]).offset().top)-200&&$(n).addClass("slow-show")})},300))},hideAnswerCreditTip:function(){var e=$(".wenda-wrap").find(".js-add-tip");$.each(e,function(e,n){$(n).remove()})},serachShow:function(e){$(n.qaList).hide(),$(n.noResult).show(),"undefined"!=typeof e.list&&e.list.length>0?($(n.noResult).hide(),QA.searchrender(e)):$("#searchWarp").html("")},serachHide:function(){$(n.qaList).show(),$(n.noResult).hide(),$(n.close).hide(),$("#searchWarp").html("")},searchQA:function(e){var i=$.trim(e.value);if(i.length<=0)return QA.serachHide(),!1;$(n.close).show();var a={word:i};"sc"==n.page?a.pid=n.pid:a.cid=n.cid,$.ajax({url:t.search,data:a,type:"post",dataType:"json",success:function(e){0==e.result&&QA.serachShow(e.data)},error:function(){$.alert("系统错误！")}})},searchrender:function(i){var t=i,a=$("#qa-tpl").html(),s="";s=juicer(a,{data:{list:t.list,module:n.page,uid:n.uid,nickname:OP_CONFIG.userInfo.nickname,head:OP_CONFIG.userInfo.head}}),$("#searchWarp").html(s),"lesson"==n.page&&($("#qa-scrollbar").scrollTop(0),e.scrollbar.update($("#qa-scrollbar")))},bindEvent:function(){$("body").on("focus",n.input,function(){$(n.inputBox).addClass("active")}).on("blur",n.input,function(){$(n.inputBox).removeClass("active")}),$(n.input).on("keyup",function(){var e=this;clearTimeout(i),i=setTimeout(function(){QA.searchQA(e)},500)}),$(n.close).on("click",function(){$(n.input).val(""),QA.serachHide()}),$(n.bigContainer).on("click",".js-close-tip",QA.hideAnswerCreditTip)}},QA.init()});